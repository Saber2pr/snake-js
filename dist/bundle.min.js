var test=function(){"use strict";var h="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function e(t,e){return t(e={exports:{}},e.exports),e.exports}var r=e(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n,r){this.callbackLeft=t,this.callbackRight=e,this.callbackUp=n,this.callbackDown=r,this.offset=100,this.delta=200}return t.prototype.onLeft=function(t){return this.callbackLeft=t,this},t.prototype.onRight=function(t){return this.callbackRight=t,this},t.prototype.onUp=function(t){return this.callbackUp=t,this},t.prototype.onDown=function(t){return this.callbackDown=t,this},t.prototype.setProps=function(t,e){return void 0===t&&(t=100),void 0===e&&(e=200),this.offset=t,this.delta=e,this},t.prototype.onStart=function(t){return this.callbackStart=t,this},t.prototype.onUpdate=function(t){return this.callbackUpdate=t,this},t.prototype.onStop=function(t){return this.callbackStop=t,this},t.prototype.listen=function(t){var e,n=this;void 0===t&&(t=document.body);var r,o=0;t.addEventListener("mouseenter",function(){r="enter"}),t.addEventListener("mousedown",function(t){e=t,(r="enter")===r&&n.callbackStart&&n.callbackStart(t)}),t.addEventListener("mousemove",function(t){o++,"enter"===r&&Boolean(e)&&n.callbackUpdate&&n.callbackUpdate(t)}),t.addEventListener("mouseup",function(t){o<n.delta&&n.testPos(e,t,t),o=0,"enter"===r&&n.callbackStop&&n.callbackStop(t),e=r=null}),t.addEventListener("mouseout",function(){r=null})},t.prototype.testPos=function(t,e,n){Math.abs(e.x-t.x)<this.offset&&Math.abs(e.y-t.y)<this.offset||(Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?e.x-t.x>this.offset?this.callbackRight&&this.callbackRight(n):e.x-t.x<-this.offset&&this.callbackLeft&&this.callbackLeft(n):e.y-t.y>this.offset?this.callbackDown&&this.callbackDown(n):e.y-t.y<-this.offset&&this.callbackUp&&this.callbackUp(n))},t}();e.TouchFront=n});t(r);r.TouchFront;var a=e(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(r)});t(a);var o=e(function(t,e){function n(t,e){var n=Date.now(),r={value:e?e.delta:17},o={value:!!e&&e.cancel},i={value:e?e.delayCancel:-1},a=e?e.frames:-1,u=0,c=function(){if(Date.now()-n>r.value){if(o.value)return;if(0<a&&a<=u)return;n=Date.now(),t(r.value),u++}requestAnimationFrame(c)};return requestAnimationFrame(c),0<i.value&&setTimeout(function(){return o.value=!0},i.value),function(){return o.value=!0}}Object.defineProperty(e,"__esModule",{value:!0}),e.call=function(t,e){void 0===e&&(e=1);var n,r=0,o=function(){return e<=r||(n=t(++r),o()),n};return o()},e.schedule=n,e.scheduleOnce=function(t,e){return n(t,{delta:e,frames:1})}});t(o);o.call,o.schedule,o.scheduleOnce;var c=e(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(o)});t(c);var i=e(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function r(t){this.instance=t}return Object.defineProperty(r.prototype,"foot",{get:function(){for(var t=this;t.next;)t=t.next;return t},enumerable:!0,configurable:!0}),r.prototype.set=function(e){var n=this;return function(t){return n[e]=t,n}},r.link=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduceRight(function(t,e){return new r(e).set("next")(t)},null)},r.prototype.toArray=function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},r.prototype.forEach=function(t,e){for(var n=this,r=0;n;)t.call(e,n.instance,r,this),n=n.next,r++},r.prototype.reverse=function(){var t=new r(null);t.next=this;for(var e=t.next,n=e.next;n;)e.next=n.next,n.next=t.next,t.next=n,n=e.next;return t.next},r}();e.List=n});t(i);i.List;var u=e(function(t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=function(t){var n=this;this.instance=t,this.set=function(e){return function(t){return n[e]=t,n}}};r.Fiber=o,r.link=function(n){return n.instance.children&&n.set("child")(n.instance.children.reduceRight(function(t,e){return new o(e).set("parent")(n).set("sibling")(t)},null)).child},r.walk=function(t){t.child||r.link(t);var e=t;if(e.child)return e.child;if(e.sibling)return e.sibling;if(!e.parent)return e;for(;!e.parent.sibling;)if(!(e=e.parent).parent)return null;return e.parent.sibling},r.walkAll=function(t,e){for(var n=new o(t);n;)e(n.instance),n=r.walk(n)}});t(u);u.Fiber,u.link,u.walk,u.walkAll;var s=e(function(t,n){function e(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),e(i),e(u)});t(s);var f=e(function(t,e){var a,n;Object.defineProperty(e,"__esModule",{value:!0}),(n=a=e.Rules||(e.Rules={})).isLabel=function(t){return"Label"===t.type},n.isLabelPropsArray=function(t){return n.isLabel(t[0])},n.isNode=function(t){return"Node"===t.type},n.isNodePropsArray=function(t){return n.isNode(t[0])},n.isSprite=function(t){return"Sprite"===t.type},n.isSpritePropsArray=function(t){return n.isSprite(t[0])},n.isCanvas=function(t){return void 0!==t.getContext},n.isCtx=function(t){return void 0!==t.canvas};var r=function(){function t(t,e,n){var i=this,r=function(t,e,n){var r=document.getElementById(t);if(!r)throw"cannot get canvas element by id: "+t;if(a.isCanvas(r)){r.width=e,r.height=n;var o=r.getContext("2d");a.isCtx(o)&&(i.ctx=o)}};"object"==typeof t?r(t.elementId,t.MaxWidth,t.MaxHeight):r(t,e,n)}return t.prototype.clear=function(t){if(t){var e=t.x,n=t.y,r=t.width,o=t.height;return this.ctx.clearRect(e,n,r,o),this}return this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this},t.prototype.fillNode=function(t){var e=t.x,n=t.y,r=t.width,o=t.height,i=t.color;this.ctx.fillStyle=i,this.ctx.fillRect(e,n,r,o)},t.prototype.fillLabel=function(t){var e=t.x,n=t.y,r=t.height,o=t.color,i=t.fontSize,a=t.fontStyle,u=t.text;this.ctx.font=String(i)+"px "+a,this.ctx.strokeStyle=o,this.ctx.strokeText(u,e,n+r)},t.prototype.fillImage=function(t){var e=this,n=t.x,r=t.y,o=t.width,i=t.height,a=t.img;a.onloadend=function(){return e.ctx.drawImage(a,n,r,o,i)}},t.prototype.getImageData=function(t,e,n,r){return this.ctx.getImageData(t,e,n,r)},t.prototype.draw=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 0<t.length&&(a.isLabelPropsArray(t)?t.forEach(function(t){return e.fillLabel(t)}):a.isNodePropsArray(t)?t.forEach(function(t){return e.fillNode(t)}):a.isSpritePropsArray(t)&&t.forEach(function(t){return e.fillImage(t)})),this},t}();e.Canvas=r});t(f);f.Rules,f.Canvas;var l=e(function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.negative=function(t){return 0===t?0:-1*t},r.square=function(t){return Math.pow(t,2)},r.magnitude2d=function(t,e){return Math.sqrt(r.square(t)+r.square(e))},r.magnitude3d=function(t,e,n){return Math.sqrt(r.square(t)+r.square(e)+r.square(n))},r.angleToRad=function(t){return t*Math.PI/180},r.radToAngle=function(t){return 180*t/Math.PI};var n=function(){function e(t,e){var n=this;this.x=t,this.y=e,this.props=function(){return{x:n.x,y:n.y}}}return e.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.scale=function(t){return this.mul(new e(t,t))},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.neg=function(){return new e(r.negative(this.x),r.negative(this.y))},e.prototype.mag=function(){return r.magnitude2d(this.x,this.y)},e.prototype.angleWith=function(t){return Math.acos(this.dot(t)/(this.mag()*t.mag()))},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return new o(0,0,this.x*t.y-this.y*t.x)},e.prototype.unitized=function(){return new e(this.x/this.mag(),this.y/this.mag())},e}();r.Vec2=n,r.v2=function(t,e){return"object"==typeof t?new n(t.x,t.y):new n(t,e||t)};var o=function(){function e(t,e,n){var r=this;this.x=t,this.y=e,this.z=n,this.props=function(){return{x:r.x,y:r.y,z:r.z}}}return e.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y,this.z*t.z)},e.prototype.scale=function(t){return this.mul(new e(t,t,t))},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y,this.z/t.z)},e.prototype.neg=function(){return new e(r.negative(this.x),r.negative(this.y),r.negative(this.z))},e.prototype.mag=function(){return r.magnitude3d(this.x,this.y,this.z)},e.prototype.angleWith=function(t){return Math.acos(this.dot(t)/(this.mag()*t.mag()))},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},e.prototype.cross=function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},e.prototype.unitized=function(){return new e(this.x/this.mag(),this.y/this.mag(),this.z/this.mag())},e}();r.Vec3=o;var e=function(){function o(t,e){this.start=t,this.end=e}return o.prototype.projection=function(t){var e=this.toVec().angleWith(t.toVec()),n=this.toVec().mag()*Math.cos(e),r=t.toVec().unitized();return new o(t.start,r.scale(n))},o.prototype.toVec=function(){return this.end.sub(this.start)},o}();r.Line2D=e;var i=function(){function o(t,e){this.start=t,this.end=e}return o.prototype.projection=function(t){var e=this.toVec().angleWith(t.toVec()),n=this.toVec().mag()*Math.cos(e),r=t.toVec().unitized();return new o(t.start,r.scale(n))},o.prototype.toVec=function(){return this.end.sub(this.start)},o}();r.Line3D=i});t(l);l.negative,l.square,l.magnitude2d,l.magnitude3d,l.angleToRad,l.radToAngle,l.Vec2,l.v2,l.Vec3,l.Line2D,l.Line3D;var p=e(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(l)});t(p);var y=e(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.width=t,this.height=e};e.Size=n});t(y);y.Size;var d=e(function(t,e){var r,o=h&&h.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.x=0,this.y=0,this.width=t,this.height=e,this.type="Rect"}return t.prototype.setPosition=function(t,e){return"number"==typeof t?(this.x=t,this.y=void 0===e?t:e):(this.x=t.x,this.y=t.y),this},t.prototype.getPosition=function(){return p.v2(this.x,this.y)},t.prototype.setSize=function(t,e){return this.width=t,this.height=e,this},t.prototype.getContentSize=function(){return new y.Size(this.width,this.height)},t}(),i=function(r){function t(t,e){var n=r.call(this,t,e)||this;return n.color="#3a32af",n.type="Node",n}return o(t,r),t.prototype.setColor=function(t){return this.color=t,this},t}(e.Rect=n),a=function(r){function t(t,e){void 0===e&&(e=23);var n=r.call(this,t.length*e,e)||this;return n.fontStyle="serif",n.color="563a6d",n.text=t,n.fontSize=e,n.type="Label",n}return o(t,r),t.prototype.setFontSize=function(t){return this.fontSize=t,this.setSize(this.text.length*t,t),this},t.prototype.setFontStyle=function(t){return this.fontStyle=t,this},t.prototype.setText=function(t){return this.text=t,this},t}(e.Node=i);e.Label=a;var u=function(n){function t(t){var e=n.call(this,0,0)||this;return e.type="Sprite",e.img=new Image,e.img.src=t,e.setSize(e.img.width,e.img.height),e}return o(t,n),t.prototype.setSrc=function(t){return this.img.src=t,this},t}(n);e.Sprite=u});t(d);d.Rect,d.Node,d.Label,d.Sprite;var n,v,g=e(function(t,n){function e(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),e(f),e(d),e(y),e(p)});t(g),v=n||(n={}),function(t){var e="object"==typeof h?h:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=r(v);function r(n,r){return function(t,e){"function"!=typeof n[t]&&Object.defineProperty(n,t,{configurable:!0,writable:!0,value:e}),r&&r(t,e)}}void 0===e.Reflect?e.Reflect=v:n=r(e.Reflect,n),function(t){var c=Object.prototype.hasOwnProperty,e="function"==typeof Symbol,i=e&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",f=e&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",n="function"==typeof Object.create,r={__proto__:[]}instanceof Array,o=!n&&!r,s={create:n?function(){return A(Object.create(null))}:r?function(){return A({__proto__:null})}:function(){return A({})},has:o?function(t,e){return c.call(t,e)}:function(t,e){return e in t},get:o?function(t,e){return c.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},a=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var o={},n=[],e=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[f]=function(){return this},t.prototype.next=function(){var t=this._index;if(0<=t&&t<this._keys.length){var e=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=n,this._values=n):this._index++,{value:e,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw 0<=this._index&&(this._index=-1,this._keys=n,this._values=n),t},t.prototype.return=function(t){return 0<=this._index&&(this._index=-1,this._keys=n,this._values=n),{value:t,done:!0}},t}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=o,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return 0<=this._find(t,!1)},t.prototype.get=function(t){var e=this._find(t,!1);return 0<=e?this._values[e]:void 0},t.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},t.prototype.delete=function(t){var e=this._find(t,!1);if(0<=e){for(var n=this._keys.length,r=e+1;r<n;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=o,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=o,this._cacheIndex=-2},t.prototype.keys=function(){return new e(this._keys,this._values,r)},t.prototype.values=function(){return new e(this._keys,this._values,i)},t.prototype.entries=function(){return new e(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[f]=function(){return this.entries()},t.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},t}();function r(t,e){return t}function i(t,e){return e}function a(t,e){return[t,e]}}():Map,p=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new h}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[f]=function(){return this.keys()},t}():Set,l=new(u||"function"!=typeof WeakMap?function(){var i=16,e=s.create(),n=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&s.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?s.get(e,this._key):void 0},t.prototype.set=function(t,e){var n=o(t,!0);return n[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){for(var t;t="@@WeakMap@@"+u(),s.has(e,t););return e[t]=!0,t}function o(t,e){if(!c.call(t,n)){if(!e)return;Object.defineProperty(t,n,{value:s.create()})}return t[n]}function a(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function u(){var t,e=(t=i,"function"!=typeof Uint8Array?a(new Array(t),t):"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t));e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",r=0;r<i;++r){var o=e[r];4!==r&&6!==r&&8!==r||(n+="-"),o<16&&(n+="0"),n+=o.toString(16).toLowerCase()}return n}}():WeakMap);function y(t,e){for(var n=t.length-1;0<=n;--n){var r=t[n],o=r(e);if(!S(o)&&!M(o)){if(!z(o))throw new TypeError;e=o}}return e}function d(t,e,n,r){for(var o=t.length-1;0<=o;--o){var i=t[o],a=i(e,n,r);if(!S(a)&&!M(a)){if(!P(a))throw new TypeError;r=a}}return r}function v(t,e,n){var r=l.get(t);if(S(r)){if(!n)return;r=new h,l.set(t,r)}var o=r.get(e);if(S(o)){if(!n)return;o=new h,r.set(e,o)}return o}function g(t,e,n){var r=_(t,e,n);if(r)return!0;var o=C(e);return!M(o)&&g(t,o,n)}function _(t,e,n){var r=v(e,n,!1);return!S(r)&&!!r.has(t)}function b(t,e,n){var r=_(t,e,n);if(r)return w(t,e,n);var o=C(e);return M(o)?void 0:b(t,o,n)}function w(t,e,n){var r=v(e,n,!1);if(!S(r))return r.get(t)}function m(t,e,n,r){var o=v(n,r,!0);o.set(t,e)}function x(t,e){var n=j(t,e),r=C(t);if(null===r)return n;var o=x(r,e);if(o.length<=0)return n;if(n.length<=0)return o;for(var i=new p,a=[],u=0,c=n;u<c.length;u++){var s=c[u],f=i.has(s);f||(i.add(s),a.push(s))}for(var h=0,l=o;h<l.length;h++){var s=l[h],f=i.has(s);f||(i.add(s),a.push(s))}return a}function j(t,e){var n=[],r=v(t,e,!1);if(S(r))return n;for(var o,i=r.keys(),a=function(t){var e=T(t,f);if(!F(e))throw new TypeError;var n=e.call(t);if(!P(n))throw new TypeError;return n}(i),u=0;;){var c=!(o=a.next()).done&&o;if(!c)return n.length=u,n;var s=c.value;try{n[u]=s}catch(t){try{L(a)}finally{throw t}}u++}}function O(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function S(t){return void 0===t}function M(t){return null===t}function P(t){return"object"==typeof t?null!==t:"function"==typeof t}function R(t,e){switch(O(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",r=T(t,i);if(void 0===r)return function(t,e){if("string"===e){var n=t.toString;if(F(n)){var r=n.call(t);if(!P(r))return r}var o=t.valueOf;if(F(o)){var r=o.call(t);if(!P(r))return r}}else{var o=t.valueOf;if(F(o)){var r=o.call(t);if(!P(r))return r}var i=t.toString;if(F(i)){var r=i.call(t);if(!P(r))return r}}throw new TypeError}(t,"default"===n?"number":n);var o=r.call(t,n);if(P(o))throw new TypeError;return o}function k(t){var e=R(t,3);return"symbol"==typeof e?e:""+e}function I(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function F(t){return"function"==typeof t}function z(t){return"function"==typeof t}function E(t){switch(O(t)){case 3:case 4:return!0;default:return!1}}function T(t,e){var n=t[e];if(null!=n){if(!F(n))throw new TypeError;return n}}function L(t){var e=t.return;e&&e.call(t)}function C(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===a)return e;if(e!==a)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var o=r.constructor;return"function"!=typeof o?e:o===t?e:o}function A(t){return t.__=void 0,delete t.__,t}t("decorate",function(t,e,n,r){if(S(n)){if(!I(t))throw new TypeError;if(!z(e))throw new TypeError;return y(t,e)}if(!I(t))throw new TypeError;if(!P(e))throw new TypeError;if(!P(r)&&!S(r)&&!M(r))throw new TypeError;return M(r)&&(r=void 0),n=k(n),d(t,e,n,r)}),t("metadata",function(n,r){function t(t,e){if(!P(t))throw new TypeError;if(!S(e)&&!E(e))throw new TypeError;m(n,r,t,e)}return t}),t("defineMetadata",function(t,e,n,r){if(!P(n))throw new TypeError;return S(r)||(r=k(r)),m(t,e,n,r)}),t("hasMetadata",function(t,e,n){if(!P(e))throw new TypeError;return S(n)||(n=k(n)),g(t,e,n)}),t("hasOwnMetadata",function(t,e,n){if(!P(e))throw new TypeError;return S(n)||(n=k(n)),_(t,e,n)}),t("getMetadata",function(t,e,n){if(!P(e))throw new TypeError;return S(n)||(n=k(n)),b(t,e,n)}),t("getOwnMetadata",function(t,e,n){if(!P(e))throw new TypeError;return S(n)||(n=k(n)),w(t,e,n)}),t("getMetadataKeys",function(t,e){if(!P(t))throw new TypeError;return S(e)||(e=k(e)),x(t,e)}),t("getOwnMetadataKeys",function(t,e){if(!P(t))throw new TypeError;return S(e)||(e=k(e)),j(t,e)}),t("deleteMetadata",function(t,e,n){if(!P(e))throw new TypeError;S(n)||(n=k(n));var r=v(e,n,!1);if(S(r))return!1;if(!r.delete(t))return!1;if(0<r.size)return!0;var o=l.get(e);return o.delete(n),0<o.size||l.delete(e),!0})}(n)}();var _=e(function(t,e){var o=h&&h.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;0<=u;u--)(o=t[u])&&(a=(i<3?o(a):3<i?o(e,n,a):o(e,n))||a);return 3<i&&a&&Object.defineProperty(e,n,a),a},i=h&&h.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var a,u={},c=["Number","String","Boolean","undefined","Array"],s=function(t){return"saber_meta:"+t};function f(r,t){var o=Reflect.get(r,t);return Reflect.set(r,t,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0];return a.isStatic(n)?n:(function(t){if(c.includes(Reflect.get(t,"name")))throw new Error("the param of class["+Reflect.getMetadata("saber_visited",u)+"]'s constructor has invalid type: "+t.name);Reflect.defineMetadata("saber_visited",t.name,u)}(n),o.apply(r,t))}),o}e.Injectable=function(e){return function(t){if(Reflect.hasMetadata(s(e),u))throw new Error("id:["+e+"] is existed!");Reflect.defineMetadata(s(e||Reflect.get(t,"name")),t,u)}},e.Inject=function(r){return function(t,e,n){return Reflect.defineMetadata(s(r),n,t)}},e.Bootstrap=function(t){Reflect.defineMetadata("saber_main",void 0,t)},e.Singleton=function(t){Reflect.defineMetadata("saber_static",void 0,t)},e.Static=function(t){Reflect.defineMetadata("saber_static",void 0,t)},(a||(a={})).isStatic=function(t){return Reflect.hasMetadata("saber_static",t)},function(t){var r=function(){function t(){}var e;return t.create=function(r){var e=this,o=[];Reflect.hasMetadata("design:paramtypes",r)&&Reflect.getMetadata("design:paramtypes",r).forEach(function(t,e){"Object"!==Reflect.get(t,"name")&&(o[e]=t)}),Reflect.getMetadataKeys(r).filter(function(t){return-1!==t.indexOf("saber_meta")}).forEach(function(t){if(!Reflect.hasMetadata(t,u))throw new Error("cannot found "+t.replace("saber_meta","dependence")+" in container.");var e=Reflect.getMetadata(t,r),n=Reflect.getMetadata(t,u);o[e]=n});var t=o.map(function(t){return e.create(t)});return new(r.bind.apply(r,[void 0].concat(t)))},o([f,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype","function"==typeof(e="undefined"!=typeof T&&T)?e:Object)],t,"create",null),t}();function e(t,e){var n=r.create(t);Reflect.has(t.prototype,"main")?Reflect.get(t.prototype,"main").apply(n):Reflect.get(t.prototype,e||Reflect.ownKeys(t.prototype)[1]).apply(n)}t.Factory=r,t.BootStrap=e;var n=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.main=t.find(function(t){return Reflect.hasMetadata("saber_main",t)})||t[0]}return t.prototype.pull=function(){return r.create(this.main)},t.prototype.run=function(t){e(t||this.main)},t}();t.Container=n}(e.SaIOC||(e.SaIOC={}))});t(_);_.Injectable,_.Inject,_.Bootstrap,_.Singleton,_.Static,_.SaIOC;var b=e(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(_)});t(b);var w=e(function(t,n){var e=h&&h.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(n,"__esModule",{value:!0});var r=e(g);n.Modules=Object.keys(r).map(function(t){return r[t].name&&r[t]}).filter(function(t){return t}),n.registerModule=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.Modules.push.apply(n.Modules,t)}});t(w);w.Modules,w.registerModule;var m=e(function(t,e){var n=h&&h.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a,u=n(g);e.createCanvas=function(i){return function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];a=new u.Canvas(i),w.Modules.forEach(function(t){return b.Injectable()(t)});var r,o=(new((t=b.SaIOC.Container).bind.apply(t,[void 0].concat(e)))).pull();c.schedule((r=o,function(e){a.clear(),s.walkAll(r,function(t){t.node&&a.draw(t.node),t.update&&t.update(e)})}),{delta:1e3/(i.fps||60)})}}});t(m);m.createCanvas;var x=e(function(t,n){function e(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),e(m),e(w),e(g),e(c),e(b)});t(x);var j=e(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.config={elementId:"root",MaxWidth:500,MaxHeight:500,bodySize:50,colors:{food:"yellow",body:"green",background:"blue",head:"red"},fps:1}});t(j);j.config;var O=e(function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),(n=e.InjSym||(e.InjSym={})).Factory="Factory",n.Rander="Rander",n.Scene="Scene",n.Snake="Snake",n.Node="Node",n.TouchFront="TouchFront",n.Label="Label"});t(O);O.InjSym;var S=e(function(t,e){var n=h&&h.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;0<=u;u--)(o=t[u])&&(a=(i<3?o(a):3<i?o(e,n,a):o(e,n))||a);return 3<i&&a&&Object.defineProperty(e,n,a),a},r=h&&h.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=h&&h.__param||function(n,r){return function(t,e){r(t,e,n)}};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this.node=t,this.Factory=e;var n=j.config.bodySize,r=j.config.colors.body,o=this.Factory.getInstance().createListNode(new x.Node(n,n).setColor(r).setPosition(50,0));this.foot=this.Factory.getInstance().createListNode(this.node.setSize(n,n).setColor(r)).set("next")(o),this.children=[this.Factory.getInstance().createComponent(o.instance),this.Factory.getInstance().createComponent(this.foot.instance)],this.step=n}return Object.defineProperty(t.prototype,"head",{get:function(){for(var t=this.foot;t.next;)t=t.next;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){for(var t=1,e=this.foot;e.next;)e=e.next,t++;return t},enumerable:!0,configurable:!0}),t.prototype.move=function(t){for(var e=this.foot;e.next;){var n=e.next.instance.getPosition();e.instance.setPosition(n),e=e.next}return e.instance.setPosition(this.getNextPos(t)),this},t.prototype.eat=function(t){this.head.next=new s.List(t)},t.prototype.meet=function(t){return this.head.instance.getPosition().equals(t)},t.prototype.getNextPos=function(t){var e=this.head.instance.getPosition();switch(t){case"down":return x.v2(e.x,e.y-this.step);case"left":return x.v2(e.x-this.step,e.y);case"right":return x.v2(e.x+this.step,e.y);case"up":return x.v2(e.x,e.y+this.step)}},t=n([x.Injectable(O.InjSym.Snake),o(0,x.Inject(O.InjSym.Node)),o(1,x.Inject(O.InjSym.Factory)),r("design:paramtypes",[x.Node,Object])],t)}();e.Snake=i});t(S);S.Snake;var M=e(function(t,e){var n=h&&h.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;0<=u;u--)(o=t[u])&&(a=(i<3?o(a):3<i?o(e,n,a):o(e,n))||a);return 3<i&&a&&Object.defineProperty(e,n,a),a},r=h&&h.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},o=h&&h.__param||function(n,r){return function(t,e){r(t,e,n)}};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n,r,o){var i=this;this.snake=t,this.node=e,this.TouchFront=n,this.Factory=r,this.Rander=o,this.children=[],this.currentFront="right";var a=j.config.MaxHeight,u=j.config.MaxWidth,c=j.config.colors.background;this.currentFood=this.createFood(),this.TouchFront.onLeft(function(){return i.currentFront="left"}).onRight(function(){return i.currentFront="right"}).onUp(function(){return i.currentFront="down"}).onDown(function(){return i.currentFront="up"}).listen(),this.node.setSize(a,u).setColor(c),this.score=new x.Label(String(this.snake.length)).setPosition(100,0);var s=new x.Label("score:");this.children.push(this.snake,this.Factory.getInstance().createComponent(this.score),this.Factory.getInstance().createComponent(s))}return t.prototype.createFood=function(){var t=j.config.bodySize,e=new x.Node(t,t).setPosition(this.Rander.getRandPos(j.config)).setColor(this.Rander.getRandColor());return this.children.push(this.Factory.getInstance().createComponent(e)),e},t.prototype.update=function(){this.snake.move(this.currentFront).meet(this.currentFood.getPosition())&&(this.snake.eat(this.currentFood),this.score.text=String(Number(this.score.text)+1),this.currentFood=this.createFood())},t=n([x.Bootstrap,x.Injectable(O.InjSym.Scene),o(0,x.Inject(O.InjSym.Snake)),o(1,x.Inject(O.InjSym.Node)),o(2,x.Inject(O.InjSym.TouchFront)),o(3,x.Inject(O.InjSym.Factory)),o(4,x.Inject(O.InjSym.Rander)),r("design:paramtypes",[Object,x.Node,a.TouchFront,Object,Object])],t)}();e.Scene=i});t(M);M.Scene;var P=e(function(t,e){var n=h&&h.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;0<=u;u--)(o=t[u])&&(a=(i<3?o(a):3<i?o(e,n,a):o(e,n))||a);return 3<i&&a&&Object.defineProperty(e,n,a),a},r=h&&h.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){}var e;return(e=t).getInstance=function(){return this.instance||(this.instance=new e)},t.prototype.createComponent=function(t){return{node:t}},t.prototype.createListNode=function(t){return new s.List(t)},t=e=n([x.Singleton,x.Injectable(O.InjSym.Factory),r("design:paramtypes",[])],t)}();e.Factory=o});t(P);P.Factory;var R=e(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.random=function(t,e){return void 0===e&&(e=0),e+(t-e)*Math.random()},n.rand=function(t,e){return void 0===e&&(e=0),parseInt(String(n.random(t,e)))},n.randVec=function(t,e){return void 0===e&&(e=t),{x:n.rand(t),y:n.rand(e)}},n.uuid=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}});t(R);R.random,R.rand,R.randVec,R.uuid;var k=e(function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(R)});t(k);var I=e(function(t,e){var n=h&&h.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;0<=u;u--)(o=t[u])&&(a=(i<3?o(a):3<i?o(e,n,a):o(e,n))||a);return 3<i&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.getRandPos=function(t){var e=t.bodySize,n=t.MaxWidth,r=t.MaxHeight,o=k.rand(n/e),i=k.rand(r/e);return g.v2(e*o,e*i)},t.getRandColor=function(){var t=k.rand(0,10);return 8<t?"red":6<t?"green":4<t?"black":2<t?"grey":"yellow"},t=n([x.Static,x.Injectable(O.InjSym.Rander)],t)}();e.Rander=r});t(I);I.Rander;return t(e(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),x.registerModule(a.TouchFront),alert("鼠标滑动方向控制移动！准备好了么？"),x.createCanvas(j.config)(S.Snake,M.Scene,P.Factory,I.Rander)}))}();